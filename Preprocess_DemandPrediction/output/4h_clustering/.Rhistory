dir<-"/Users/Lei/Desktop/work in IBM/Code/Clustering_Investigation/D42/"
setwd(paste(dir,"data",sep=''))#set the file path
zc<-read.csv('zipcode.csv',header=F)
setwd(paste(dir,"output/4h_clustering",sep=''))
oURL="merge_result/hierarchical"
oURL2="zip_hierarchical"
file_list_std <- list.files()
for (file in file_list_std){
#vector to save the top 1 keyword of a cluster
tkw<-vector()
dt<-read.csv(file)
nCluster=9
nFeature=13#change this to reflect number of cluster
dt_cl<-unique(dt$Hierarchical)#dt$Kmeans dt$Hierarchical
id<-seq(1:nCluster)
cFeature<-data.frame(id)
for (i in 0:(nFeature-1)){
cluster_feature<-vector()
#------change this 5
dt_tmp<-dt[dt$Hierarchical==i,]
for (j in 5:13){
cluster_feature<-c(cluster_feature,sum(dt_tmp[,j])/nrow(dt_tmp))
}
cFeature[,i+2]<-cluster_feature
}
names(cFeature)<-c('id','cluster1','cluster2','cluster3','cluster4',
'cluster5','cluster6','cluster7','cluster8','cluster9'
,'cluster10','cluster11','cluster12','cluster13')
cFeature$id<-paste('F',cFeature$id,sep='')
cFeature$id<-ifelse(cFeature$id=='F1','Entertainment',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F2','Education',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F3','NightLife',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F4','Recreation',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F5','SocialServices',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F6','Residence',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F7','Shopping',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F8','Traveling',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F9','Eating',cFeature$id)
for (i in 1:nFeature+1){
tmp<-cFeature[order(-cFeature[,i]),]
tkw<-append(tkw,tmp[1,]$id)
cFeature[,i]<-paste(cFeature[order(-cFeature[,i]),]$id, '(', round(cFeature[order(-cFeature[,i]),][,i],2),')')
}
setwd(paste(dir,"output",sep=''))
cFeature$id<-NULL
write.table(cFeature,file=paste(oURL, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
dt2<-read.csv(file)
dt2$X<-as.character(zc$V1)
dt2$X<-ifelse(dt2$X=='83','00083',dt2$X)
result<-data.frame(dt2$X,dt2$Hierarchical)
names(result)<-c('zipcode','cluster')
topkw<-vector()
for (h in 1:nrow(result)){
topkw<-append(topkw,tkw[[result[h,]$cluster+1]])
}
result$topkw<-topkw
setwd(paste(dir,"output/cluster_with_kw",sep=''))
write.table(result,file=paste(oURL2, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
}
tkw
cFeature
#vector to save the top 1 keyword of a cluster
tkw<-vector()
dt<-read.csv(file)
nCluster=9
nFeature=13#change this to reflect number of cluster
dt_cl<-unique(dt$Hierarchical)#dt$Kmeans dt$Hierarchical
id<-seq(1:nCluster)
cFeature<-data.frame(id)
for (i in 0:(nFeature-1)){
cluster_feature<-vector()
#------change this 5
dt_tmp<-dt[dt$Hierarchical==i,]
for (j in 5:13){
cluster_feature<-c(cluster_feature,sum(dt_tmp[,j])/nrow(dt_tmp))
}
cFeature[,i+2]<-cluster_feature
}
names(cFeature)<-c('id','cluster1','cluster2','cluster3','cluster4',
'cluster5','cluster6','cluster7','cluster8','cluster9'
,'cluster10','cluster11','cluster12','cluster13')
cFeature$id<-paste('F',cFeature$id,sep='')
cFeature$id<-ifelse(cFeature$id=='F1','Entertainment',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F2','Education',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F3','NightLife',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F4','Recreation',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F5','SocialServices',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F6','Residence',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F7','Shopping',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F8','Traveling',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F9','Eating',cFeature$id)
for (i in 1:nFeature+1){
tmp<-cFeature[order(-cFeature[,i]),]
tkw<-append(tkw,tmp[1,]$id)
cFeature[,i]<-paste(cFeature[order(-cFeature[,i]),]$id, '(', round(cFeature[order(-cFeature[,i]),][,i],2),')')
}
setwd(paste(dir,"output",sep=''))
cFeature$id<-NULL
cFeature
nFeature+1
rm(list=ls())
dir<-"/Users/Lei/Desktop/work in IBM/Code/Clustering_Investigation/D42/"
setwd(paste(dir,"data",sep=''))#set the file path
zc<-read.csv('zipcode.csv',header=F)
setwd(paste(dir,"output/4h_clustering",sep=''))
oURL="merge_result/hierarchical"
oURL2="zip_hierarchical"
file_list_std <- list.files()
for (file in file_list_std){
#vector to save the top 1 keyword of a cluster
tkw<-vector()
dt<-read.csv(file)
nCluster=9
nFeature=13#change this to reflect number of cluster
dt_cl<-unique(dt$Hierarchical)#dt$Kmeans dt$Hierarchical
id<-seq(1:nCluster)
cFeature<-data.frame(id)
for (i in 0:(nFeature-1)){
cluster_feature<-vector()
#------change this 5
dt_tmp<-dt[dt$Hierarchical==i,]
for (j in 5:13){
cluster_feature<-c(cluster_feature,sum(dt_tmp[,j])/nrow(dt_tmp))
}
cFeature[,i+2]<-cluster_feature
}
names(cFeature)<-c('id','cluster1','cluster2','cluster3','cluster4',
'cluster5','cluster6','cluster7','cluster8','cluster9'
,'cluster10','cluster11','cluster12','cluster13')
cFeature$id<-paste('F',cFeature$id,sep='')
cFeature$id<-ifelse(cFeature$id=='F1','Entertainment',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F2','Education',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F3','NightLife',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F4','Recreation',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F5','SocialServices',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F6','Residence',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F7','Shopping',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F8','Traveling',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F9','Eating',cFeature$id)
for (i in 1:nFeature){
tmp<-cFeature[order(-cFeature[,i]),]
tkw<-append(tkw,tmp[1,]$id)
cFeature[,i]<-paste(cFeature[order(-cFeature[,i]),]$id, '(', round(cFeature[order(-cFeature[,i]),][,i],2),')')
}
setwd(paste(dir,"output",sep=''))
cFeature$id<-NULL
write.table(cFeature,file=paste(oURL, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
dt2<-read.csv(file)
dt2$X<-as.character(zc$V1)
dt2$X<-ifelse(dt2$X=='83','00083',dt2$X)
result<-data.frame(dt2$X,dt2$Hierarchical)
names(result)<-c('zipcode','cluster')
topkw<-vector()
for (h in 1:nrow(result)){
topkw<-append(topkw,tkw[[result[h,]$cluster+1]])
}
result$topkw<-topkw
setwd(paste(dir,"output/cluster_with_kw",sep=''))
write.table(result,file=paste(oURL2, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
}
#vector to save the top 1 keyword of a cluster
tkw<-vector()
dt<-read.csv(file)
nCluster=9
nFeature=13#change this to reflect number of cluster
dt_cl<-unique(dt$Hierarchical)#dt$Kmeans dt$Hierarchical
id<-seq(1:nCluster)
cFeature<-data.frame(id)
for (i in 0:(nFeature-1)){
cluster_feature<-vector()
#------change this 5
dt_tmp<-dt[dt$Hierarchical==i,]
for (j in 5:13){
cluster_feature<-c(cluster_feature,sum(dt_tmp[,j])/nrow(dt_tmp))
}
cFeature[,i+2]<-cluster_feature
}
names(cFeature)<-c('id','cluster1','cluster2','cluster3','cluster4',
'cluster5','cluster6','cluster7','cluster8','cluster9'
,'cluster10','cluster11','cluster12','cluster13')
cFeature$id<-paste('F',cFeature$id,sep='')
cFeature$id<-ifelse(cFeature$id=='F1','Entertainment',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F2','Education',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F3','NightLife',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F4','Recreation',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F5','SocialServices',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F6','Residence',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F7','Shopping',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F8','Traveling',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F9','Eating',cFeature$id)
for (i in 1:nFeature+1){
tmp<-cFeature[order(-cFeature[,i]),]
tkw<-append(tkw,tmp[1,]$id)
cFeature[,i]<-paste(cFeature[order(-cFeature[,i]),]$id, '(', round(cFeature[order(-cFeature[,i]),][,i],2),')')
}
setwd(paste(dir,"output",sep=''))
cFeature$id<-NULL
cFeature
rm(list=ls())
dir<-"/Users/Lei/Desktop/work in IBM/Code/Clustering_Investigation/D42/"
setwd(paste(dir,"data",sep=''))#set the file path
zc<-read.csv('zipcode.csv',header=F)
setwd(paste(dir,"output/4h_clustering",sep=''))
oURL="merge_result/hierarchical"
oURL2="zip_hierarchical"
file_list_std <- list.files()
for (file in file_list_std){
#vector to save the top 1 keyword of a cluster
tkw<-vector()
dt<-read.csv(file)
nCluster=9
nFeature=12#change this to reflect number of cluster
dt_cl<-unique(dt$Hierarchical)#dt$Kmeans dt$Hierarchical
id<-seq(1:nCluster)
cFeature<-data.frame(id)
for (i in 0:(nFeature-1)){
cluster_feature<-vector()
#------change this 5
dt_tmp<-dt[dt$Hierarchical==i,]
for (j in 5:13){
cluster_feature<-c(cluster_feature,sum(dt_tmp[,j])/nrow(dt_tmp))
}
cFeature[,i+2]<-cluster_feature
}
names(cFeature)<-c('id','cluster1','cluster2','cluster3','cluster4',
'cluster5','cluster6','cluster7','cluster8','cluster9'
,'cluster10','cluster11','cluster12','cluster13')
cFeature$id<-paste('F',cFeature$id,sep='')
cFeature$id<-ifelse(cFeature$id=='F1','Entertainment',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F2','Education',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F3','NightLife',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F4','Recreation',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F5','SocialServices',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F6','Residence',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F7','Shopping',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F8','Traveling',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F9','Eating',cFeature$id)
for (i in 1:nFeature+1){
tmp<-cFeature[order(-cFeature[,i]),]
tkw<-append(tkw,tmp[1,]$id)
cFeature[,i]<-paste(cFeature[order(-cFeature[,i]),]$id, '(', round(cFeature[order(-cFeature[,i]),][,i],2),')')
}
setwd(paste(dir,"output",sep=''))
cFeature$id<-NULL
write.table(cFeature,file=paste(oURL, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
dt2<-read.csv(file)
dt2$X<-as.character(zc$V1)
dt2$X<-ifelse(dt2$X=='83','00083',dt2$X)
result<-data.frame(dt2$X,dt2$Hierarchical)
names(result)<-c('zipcode','cluster')
topkw<-vector()
for (h in 1:nrow(result)){
topkw<-append(topkw,tkw[[result[h,]$cluster+1]])
}
result$topkw<-topkw
setwd(paste(dir,"output/cluster_with_kw",sep=''))
write.table(result,file=paste(oURL2, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
}
rm(list=ls())
dir<-"/Users/Lei/Desktop/work in IBM/Code/Clustering_Investigation/D42/"
setwd(paste(dir,"data",sep=''))#set the file path
zc<-read.csv('zipcode.csv',header=F)
setwd(paste(dir,"output/4h_clustering",sep=''))
oURL="merge_result/hierarchical"
oURL2="zip_hierarchical"
file_list_std <- list.files()
for (file in file_list_std){
#vector to save the top 1 keyword of a cluster
tkw<-vector()
dt<-read.csv(file)
nCluster=9
nFeature=15#change this to reflect number of cluster
dt_cl<-unique(dt$Hierarchical)#dt$Kmeans dt$Hierarchical
id<-seq(1:nCluster)
cFeature<-data.frame(id)
for (i in 0:(nFeature-1)){
cluster_feature<-vector()
#------change this 5
dt_tmp<-dt[dt$Hierarchical==i,]
for (j in 5:13){
cluster_feature<-c(cluster_feature,sum(dt_tmp[,j])/nrow(dt_tmp))
}
cFeature[,i+2]<-cluster_feature
}
names(cFeature)<-c('id','cluster1','cluster2','cluster3','cluster4',
'cluster5','cluster6','cluster7','cluster8','cluster9'
,'cluster10','cluster11','cluster12','cluster13')
cFeature$id<-paste('F',cFeature$id,sep='')
cFeature$id<-ifelse(cFeature$id=='F1','Entertainment',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F2','Education',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F3','NightLife',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F4','Recreation',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F5','SocialServices',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F6','Residence',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F7','Shopping',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F8','Traveling',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F9','Eating',cFeature$id)
for (i in 1:nFeature+1){
tmp<-cFeature[order(-cFeature[,i]),]
tkw<-append(tkw,tmp[1,]$id)
cFeature[,i]<-paste(cFeature[order(-cFeature[,i]),]$id, '(', round(cFeature[order(-cFeature[,i]),][,i],2),')')
}
setwd(paste(dir,"output",sep=''))
cFeature$id<-NULL
write.table(cFeature,file=paste(oURL, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
dt2<-read.csv(file)
dt2$X<-as.character(zc$V1)
dt2$X<-ifelse(dt2$X=='83','00083',dt2$X)
result<-data.frame(dt2$X,dt2$Hierarchical)
names(result)<-c('zipcode','cluster')
topkw<-vector()
for (h in 1:nrow(result)){
topkw<-append(topkw,tkw[[result[h,]$cluster+1]])
}
result$topkw<-topkw
setwd(paste(dir,"output/cluster_with_kw",sep=''))
write.table(result,file=paste(oURL2, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
}
rm(list=ls())
dir<-"/Users/Lei/Desktop/work in IBM/Code/Clustering_Investigation/D42/"
setwd(paste(dir,"data",sep=''))#set the file path
zc<-read.csv('zipcode.csv',header=F)
setwd(paste(dir,"output/4h_clustering",sep=''))
oURL="merge_result/hierarchical"
oURL2="zip_hierarchical"
file_list_std <- list.files()
for (file in file_list_std){
#vector to save the top 1 keyword of a cluster
tkw<-vector()
dt<-read.csv(file)
nCluster=9
nFeature=12#change this to reflect number of cluster
dt_cl<-unique(dt$Hierarchical)#dt$Kmeans dt$Hierarchical
id<-seq(1:nCluster)
cFeature<-data.frame(id)
for (i in 0:(nFeature-1)){
cluster_feature<-vector()
#------change this 5
dt_tmp<-dt[dt$Hierarchical==i,]
for (j in 5:13){
cluster_feature<-c(cluster_feature,sum(dt_tmp[,j])/nrow(dt_tmp))
}
cFeature[,i+2]<-cluster_feature
}
names(cFeature)<-c('id','cluster1','cluster2','cluster3','cluster4',
'cluster5','cluster6','cluster7','cluster8','cluster9'
,'cluster10','cluster11','cluster12','cluster13')
cFeature$id<-paste('F',cFeature$id,sep='')
cFeature$id<-ifelse(cFeature$id=='F1','Entertainment',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F2','Education',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F3','NightLife',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F4','Recreation',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F5','SocialServices',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F6','Residence',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F7','Shopping',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F8','Traveling',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F9','Eating',cFeature$id)
for (i in 1:nFeature+1){
tmp<-cFeature[order(-cFeature[,i]),]
tkw<-append(tkw,tmp[1,]$id)
cFeature[,i]<-paste(cFeature[order(-cFeature[,i]),]$id, '(', round(cFeature[order(-cFeature[,i]),][,i],2),')')
}
setwd(paste(dir,"output",sep=''))
cFeature$id<-NULL
write.table(cFeature,file=paste(oURL, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
dt2<-read.csv(file)
dt2$X<-as.character(zc$V1)
dt2$X<-ifelse(dt2$X=='83','00083',dt2$X)
result<-data.frame(dt2$X,dt2$Hierarchical)
names(result)<-c('zipcode','cluster')
topkw<-vector()
for (h in 1:nrow(result)){
topkw<-append(topkw,tkw[[result[h,]$cluster+1]])
}
result$topkw<-topkw
setwd(paste(dir,"output/cluster_with_kw",sep=''))
write.table(result,file=paste(oURL2, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
}
rm(list=ls())
dir<-"/Users/Lei/Desktop/work in IBM/Code/Clustering_Investigation/D42/"
setwd(paste(dir,"data",sep=''))#set the file path
zc<-read.csv('zipcode.csv',header=F)
setwd(paste(dir,"output/4h_clustering",sep=''))
oURL="merge_result/hierarchical"
oURL2="zip_hierarchical"
file_list_std <- list.files()
for (file in file_list_std){
#vector to save the top 1 keyword of a cluster
tkw<-vector()
dt<-read.csv(file)
nCluster=9
nFeature=13#change this to reflect number of cluster
dt_cl<-unique(dt$Hierarchical)#dt$Kmeans dt$Hierarchical
id<-seq(1:nCluster)
cFeature<-data.frame(id)
for (i in 0:(nFeature-1)){
cluster_feature<-vector()
#------change this 5
dt_tmp<-dt[dt$Hierarchical==i,]
for (j in 5:13){
cluster_feature<-c(cluster_feature,sum(dt_tmp[,j])/nrow(dt_tmp))
}
cFeature[,i+2]<-cluster_feature
}
names(cFeature)<-c('id','cluster1','cluster2','cluster3','cluster4',
'cluster5','cluster6','cluster7','cluster8','cluster9'
,'cluster10','cluster11','cluster12','cluster13')
cFeature$id<-paste('F',cFeature$id,sep='')
cFeature$id<-ifelse(cFeature$id=='F1','Entertainment',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F2','Education',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F3','NightLife',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F4','Recreation',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F5','SocialServices',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F6','Residence',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F7','Shopping',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F8','Traveling',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F9','Eating',cFeature$id)
for (i in 1:nFeature+1){
tmp<-cFeature[order(-cFeature[,i]),]
tkw<-append(tkw,tmp[1,]$id)
cFeature[,i]<-paste(cFeature[order(-cFeature[,i]),]$id, '(', round(cFeature[order(-cFeature[,i]),][,i],2),')')
}
setwd(paste(dir,"output",sep=''))
cFeature$id<-NULL
write.table(cFeature,file=paste(oURL, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
dt2<-read.csv(file)
dt2$X<-as.character(zc$V1)
dt2$X<-ifelse(dt2$X=='83','00083',dt2$X)
result<-data.frame(dt2$X,dt2$Hierarchical)
names(result)<-c('zipcode','cluster')
topkw<-vector()
for (h in 1:nrow(result)){
topkw<-append(topkw,tkw[[result[h,]$cluster+1]])
}
result$topkw<-topkw
setwd(paste(dir,"output/cluster_with_kw",sep=''))
write.table(result,file=paste(oURL2, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
}
rm(list=ls())
dir<-"/Users/Lei/Desktop/work in IBM/Code/Clustering_Investigation/D42/"
setwd(paste(dir,"data",sep=''))#set the file path
zc<-read.csv('zipcode.csv',header=F)
setwd(paste(dir,"output/4h_clustering",sep=''))
oURL="merge_result/hierarchical"
oURL2="zip_hierarchical"
file_list_std <- list.files()
for (file in file_list_std){
#vector to save the top 1 keyword of a cluster
tkw<-vector()
dt<-read.csv(file)
nCluster=9
nFeature=13#change this to reflect number of cluster, the last
dt_cl<-unique(dt$Hierarchical)#dt$Kmeans dt$Hierarchical
id<-seq(1:nCluster)
cFeature<-data.frame(id)
for (i in 0:(nFeature-1)){
cluster_feature<-vector()
#------change this 5
dt_tmp<-dt[dt$Hierarchical==i,]
for (j in 5:13){
cluster_feature<-c(cluster_feature,sum(dt_tmp[,j])/nrow(dt_tmp))
}
cFeature[,i+2]<-cluster_feature
}
names(cFeature)<-c('id','cluster1','cluster2','cluster3','cluster4',
'cluster5','cluster6','cluster7','cluster8','cluster9'
,'cluster10','cluster11','cluster12','cluster13')
cFeature$id<-paste('F',cFeature$id,sep='')
cFeature$id<-ifelse(cFeature$id=='F1','Entertainment',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F2','Education',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F3','NightLife',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F4','Recreation',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F5','SocialServices',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F6','Residence',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F7','Shopping',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F8','Traveling',cFeature$id)
cFeature$id<-ifelse(cFeature$id=='F9','Eating',cFeature$id)
for (i in 1:nFeature+1){
tmp<-cFeature[order(-cFeature[,i]),]
tkw<-append(tkw,tmp[1,]$id)
cFeature[,i]<-paste(cFeature[order(-cFeature[,i]),]$id, '(', round(cFeature[order(-cFeature[,i]),][,i],2),')')
}
setwd(paste(dir,"output",sep=''))
cFeature$id<-NULL
write.table(cFeature,file=paste(oURL, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
dt2<-read.csv(file)
dt2$X<-as.character(zc$V1)
dt2$X<-ifelse(dt2$X=='83','00083',dt2$X)
result<-data.frame(dt2$X,dt2$Hierarchical)
names(result)<-c('zipcode','cluster')
topkw<-vector()
for (h in 1:nrow(result)){
topkw<-append(topkw,tkw[[result[h,]$cluster+1]])
}
result$topkw<-topkw
setwd(paste(dir,"output/cluster_with_kw",sep=''))
write.table(result,file=paste(oURL2, file,sep=''),col.names=T, row.names=F,quote=F,sep=",")
setwd(paste(dir,"output/4h_clustering",sep=''))
}
